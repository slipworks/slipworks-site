<!-- layouts/partials/custom_header_video.html -->
<section class="blog-cover">
  <video id="hero-video" autoplay muted loop playsinline poster="{{ "images/cover-image.jpg" | relURL }}"></video>
  <div class="title-and-description-guard">
    <div class="blog-title">{{ .Site.Params.title }}</div>
    <div class="blog-description">{{ .Site.Params.description }}</div>
  </div>
</section>

<style>
.blog-cover{
  position:relative; width:100%; height:80vh; /* ← チラ見せはここで調整（例: 70–85vh） */
  overflow:hidden; background:#000;
}
#hero-video{
  position:absolute; inset:0; width:100%; height:100%;
  object-fit:cover; z-index:1;
}
.title-and-description-guard{
  position:relative; z-index:2; height:100%;
  display:flex; align-items:center; justify-content:center; flex-direction:column;
  color:#fff; text-align:center; text-shadow:0 0 8px rgba(0,0,0,.6);
  background:rgba(0,0,0,.25);
}
</style>

<script>
(function(){
  // static/images に置いた3本。webm/ mp4 の両方があれば両方を追加（互換確保）
  const candidates = [
    {webm:'{{ "images/hero1.webm" | relURL }}', mp4:'{{ "images/hero1.mp4" | relURL }}'},
    {webm:'{{ "images/hero2.webm" | relURL }}', mp4:'{{ "images/hero2.mp4" | relURL }}'},
    {webm:'{{ "images/hero3.webm" | relURL }}', mp4:'{{ "images/hero3.mp4" | relURL }}'},
  ];
  const v = document.getElementById('hero-video'); if(!v) return;

  const pick = candidates[Math.floor(Math.random()*candidates.length)];

  // 形式がある方だけ読み込む（mp4 だけでもOK）
  if (pick.webm) { const sW=document.createElement('source'); sW.src=pick.webm; sW.type='video/webm'; v.appendChild(sW); }
  if (pick.mp4)  { const sM=document.createElement('source'); sM.src=pick.mp4; sM.type='video/mp4';  v.appendChild(sM); }

  v.muted = true; v.playsInline = true;
  v.addEventListener('canplay', ()=>v.play().catch(()=>{}), {once:true});
  v.load();
})();
</script>
